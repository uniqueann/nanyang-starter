import{a as e,Q as t,g as n,O as i,L as s,C as o,B as a,Y as l,Z as r,A as c,_ as u,u as g,a0 as d,a1 as p,$ as h,o as f,c as m,w as v,i as k,b as I,l as L,k as b,t as A,j as $,p as S}from"./index-0982dc28.js";import{_ as O,a as _}from"./uni-list.41a88308.js";import{r as x}from"./uni-app.es.0abf17f1.js";import{s as T,m as P}from"./store.49192a69.js";import{_ as y}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-icons.3b963afa.js";function C(){var e=void 0;try{if("iOS"==plus.os.name){var t=0,n=plus.ios.invoke("UIApplication","sharedApplication"),i=plus.ios.invoke(n,"currentUserNotificationSettings");i?(t=i.plusGetAttribute("types"),plus.ios.deleteObject(i)):t=plus.ios.invoke(n,"enabledRemoteNotificationTypes"),plus.ios.deleteObject(n),e=0!=t}else{var s=plus.android.runtimeMainActivity(),o=plus.android.invoke("com.igexin.sdk.PushManager","getInstance");e=plus.android.invoke(o,"isPushTurnedOn",s)}}catch(a){console.error("exception in isTurnedOnPush@dc-push!!")}return e}function E(){try{if("iOS"==plus.os.name){var e=plus.ios.invoke("UIApplication","sharedApplication"),t=plus.ios.invoke("NSURL","URLWithString:","app-settings:");plus.ios.invoke(e,"openURL:",t),plus.ios.deleteObject(t),plus.ios.deleteObject(e)}}catch(n){console.error("exception in settingInIos@dc-push!!")}}const N={isOn:C,iosSetting:E,on:function(){try{if("iOS"==plus.os.name)C()||E();else{var e=plus.android.runtimeMainActivity(),t=plus.android.invoke("com.igexin.sdk.PushManager","getInstance");plus.android.invoke(t,"turnOnPush",e)}}catch(n){console.error("exception in turnOnPush@dc-push!!")}},off:function(){try{if("iOS"==plus.os.name);else{var e=plus.android.runtimeMainActivity(),t=plus.android.invoke("com.igexin.sdk.PushManager","getInstance");plus.android.invoke(t,"turnOffPush",e)}}catch(n){console.error("exception in trunOffPush@dc-push!!")}},setting:function(){"ios"==e().platform&&E(),"android"==e().platform&&function(){if("android"==e().platform){var t=plus.android.runtimeMainActivity(),n=new(plus.android.importClass("android.content.Intent"))(plus.android.importClass("android.provider.Settings").ACTION_APPLICATION_DETAILS_SETTINGS);t.startActivity(n)}}()}};const w=y({data:()=>({pushServer:N,supportMode:[],pushIsOn:"wait",currentLanguage:"",userInfo:{}}),computed:{hasLogin:()=>T.hasLogin,i18nEnable:()=>t().globalData.config.i18n.enable},onLoad(){this.currentLanguage="en"==n("CURRENT_LANG")?"English":"简体中文",i({title:this.$t("settings.navigationBarTitle")})},onShow(){},methods:{async changeLoginState(){this.hasLogin?await P.logout():s({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd"})},startSoterAuthentication(e){console.log(e);let t={fingerPrint:this.$t("settings.fingerPrint"),facial:this.$t("settings.facial")}[e];this.checkIsSoterEnrolledInDevice({checkAuthMode:e,title:t}).then((()=>{console.log(e,t),uni.startSoterAuthentication({requestAuthModes:[e],challenge:"123456",authContent:this.$t("settings.please")+` ${t}`,complete:e=>{console.log(e)},success:e=>{if(console.log(e),0==e.errCode)return o({title:`${t}`+this.$t("settings.successText"),icon:"none"});o({title:this.$t("settings.failTip"),icon:"none"})},fail:e=>{console.log(e),console.log(`认证失败:${e.errCode}`),o({title:this.$t("settings.authFailed"),icon:"none"})}})}))},checkIsSoterEnrolledInDevice({checkAuthMode:e,title:t}){return new Promise(((n,i)=>{uni.checkIsSoterEnrolledInDevice({checkAuthMode:e,success:e=>{if(console.log(e),e.isEnrolled)return n(e);o({title:this.$t("settings.deviceNoOpen")+`${t}`,icon:"none"}),i(e)},fail:e=>{console.log(e),o({title:`${t}`+this.$t("settings.fail"),icon:"none"}),i(e)}})}))},clearTmp(){a({title:this.$t("settings.clearing"),mask:!0}),l({success:e=>{e.fileList.length>0?r({filePath:e.fileList[0].filePath,complete:e=>{console.log(e),c(),o({title:this.$t("settings.clearedSuccessed"),icon:"none"})}}):(c(),o({title:this.$t("settings.clearedSuccessed"),icon:"none"}))},complete:e=>{console.log(e)}})},changeLanguage(){console.log("语言切换"),u({itemList:["English","简体中文"],success:e=>{console.log(e.tapIndex);let i=n("CURRENT_LANG");if(!e.tapIndex&&"zh-Hans"==i||e.tapIndex&&"en"==i){const n=t().globalData;i=n.locale="en"===i?"zh-Hans":"en",g("CURRENT_LANG",i),t().globalData.$i18n.locale=i,this.currentLanguage=e.tapIndex?"简体中文":"English",d&&d(i),p({url:"/pages/list/list",complete:()=>{h("changeLanguage",i)}})}},fail:()=>{},complete:()=>{}})}}},[["render",function(e,t,n,i,s,o){const a=x($("uni-list-item"),O),l=x($("uni-list"),_),r=S,c=k;return f(),m(c,{class:"content"},{default:v((()=>[I(l,{class:"mt10",border:!1},{default:v((()=>[I(a,{title:e.$t("settings.userInfo"),to:"/uni_modules/uni-id-pages/pages/userinfo/userinfo",link:"navigateTo"},null,8,["title"]),s.userInfo.mobile?(f(),m(a,{key:0,title:e.$t("settings.changePassword"),to:"/pages/ucenter/login-page/pwd-retrieve/pwd-retrieve?phoneNumber="+s.userInfo.mobile,link:"navigateTo"},null,8,["title","to"])):L("",!0)])),_:1}),I(l,{class:"mt10",border:!1},{default:v((()=>[o.i18nEnable?(f(),m(a,{key:0,title:e.$t("settings.changeLanguage"),onClick:o.changeLanguage,rightText:s.currentLanguage,link:""},null,8,["title","onClick","rightText"])):L("",!0)])),_:1}),I(c,{class:"bottom-back",onClick:o.changeLoginState},{default:v((()=>[o.hasLogin?(f(),m(r,{key:0,class:"bottom-back-text"},{default:v((()=>[b(A(e.$t("settings.logOut")),1)])),_:1})):(f(),m(r,{key:1,class:"bottom-back-text"},{default:v((()=>[b(A(e.$t("settings.login")),1)])),_:1}))])),_:1},8,["onClick"])])),_:1})}],["__scopeId","data-v-21dfd337"]]);export{w as default};
